<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>{{ book.title }}</title>
    <link rel="stylesheet" href="{{ plugin_url }}css/style.css" />
    <link rel="stylesheet" href="{{ plugin_url }}css/paged.css" media="print" />
    <script src="https://unpkg.com/pagedjs/dist/paged.polyfill.js"></script>
    {% set google_fonts = {
        'Source Serif Pro': 'Source+Serif+Pro',
        'Crimson Text': 'Crimson+Text',
        'Libre Baskerville': 'Libre+Baskerville',
        'PT Serif': 'PT+Serif'
    } %}
    {% if template.font_family in google_fonts %}
    <link href="https://fonts.googleapis.com/css2?family={{ google_fonts[template.font_family] }}&display=swap" rel="stylesheet" />
    {% endif %}
    {% if template.heading_font in google_fonts and template.heading_font != template.font_family %}
    <link href="https://fonts.googleapis.com/css2?family={{ google_fonts[template.heading_font] }}&display=swap" rel="stylesheet" />
    {% endif %}
    {% if template.doc_format or template.doc_width or template.font_family or template.font_size or template.line_height or template.heading_font or template.heading_color or template.text_color or template.background_color %}
    <style>
    @page {
        {% if template.doc_format and template.doc_format != 'Custom' %}
        size: {{ template.doc_format }}{% if template.doc_orientation %} {{ template.doc_orientation }}{% endif %};
        {% elseif template.doc_width and template.doc_height %}
        size: {{ template.doc_width }}{{ template.doc_unit }} {{ template.doc_height }}{{ template.doc_unit }}{% if template.doc_orientation %} {{ template.doc_orientation }}{% endif %};
        {% endif %}
    }
    body {
        {% if template.font_family %}font-family: '{{ template.font_family }}', serif;{% endif %}
        {% if template.font_size %}font-size: {{ template.font_size }};{% endif %}
        {% if template.line_height %}line-height: {{ template.line_height }};{% endif %}
        {% if template.text_color %}color: {{ template.text_color }};{% endif %}
        {% if template.background_color %}background-color: {{ template.background_color }};{% endif %}
    }
    h1, h2, h3, h4, h5, h6 {
        {% if template.heading_font %}font-family: '{{ template.heading_font }}', sans-serif;{% endif %}
        {% if template.heading_color %}color: {{ template.heading_color }};{% endif %}
    }
    code, pre {
        font-family: 'Courier New', Courier, monospace;
    }
    </style>
    {% endif %}
</head>
<body>
<h1>{{ book.title }}</h1>
{% if book.cover %}<img src="{{ book.cover }}" alt="Cover" />{% endif %}
<nav class="bc-nav">
    <ul>
        <li><a href="#identification">Identification</a></li>
        <li><a href="#descriptive">Descriptive</a></li>
        <li><a href="#preliminary">Preliminary Parts</a></li>
        <li><a href="#chapters">Chapters</a></li>
        <li><a href="#final">Final Parts</a></li>
    </ul>
</nav>

<section id="identification">
    {% if book.subtitle %}<h2>{{ book.subtitle }}</h2>{% endif %}
    {% if book.author %}<p class="author">{{ book.author }}</p>{% endif %}
    {% if book.coauthors %}<p class="coauthors">{{ book.coauthors }}</p>{% endif %}
    {% if book.publisher %}<p class="publisher">{{ book.publisher }}</p>{% endif %}
    {% if book.isbn %}<p class="isbn">ISBN: {{ book.isbn }}</p>{% endif %}
    {% if book.pub_date %}<p class="pub-date">{{ book.pub_date }}</p>{% endif %}
    {% if book.edition %}<p class="edition">{{ book.edition }}</p>{% endif %}
</section>

<section id="descriptive">
    {% if book.language %}<p class="language">{{ book.language }}</p>{% endif %}
    {% if book.description %}<div class="description">{{ book.description|raw }}</div>{% endif %}
    {% if book.keywords %}<p class="keywords">{{ book.keywords }}</p>{% endif %}
    {% if book.audience %}<p class="audience">{{ book.audience }}</p>{% endif %}
</section>

<section id="preliminary">
    {% if book.retina_cover %}<img src="{{ book.retina_cover }}" alt="Retina Cover" />{% endif %}
    {% if book.frontispiece %}<div class="frontispiece">{{ book.frontispiece|raw }}</div>{% endif %}
    {% if book.copyright %}<div class="copyright">{{ book.copyright|raw }}</div>{% endif %}
    {% if book.dedication %}<div class="dedication">{{ book.dedication|raw }}</div>{% endif %}
    {% if book.preface %}<div class="preface">{{ book.preface|raw }}</div>{% endif %}
</section>

<section id="chapters">
    {% for chapter in chapters %}
    <article class="chapter">
        <h2>{{ chapter.title }}</h2>
        {% if chapter.content %}<div class="chapter-content">{{ chapter.content|raw }}</div>{% endif %}
        {% for paragraph in chapter.paragraphs %}
        <div class="paragraph">
            <h3>{{ paragraph.title }}</h3>
            <div class="paragraph-content">{{ paragraph.content|raw }}</div>
        </div>
        {% endfor %}
    </article>
    {% endfor %}
</section>

<section id="final">
    {% if book.appendix %}<div class="appendix">{{ book.appendix|raw }}</div>{% endif %}
    {% if book.bibliography %}<div class="bibliography">{{ book.bibliography|raw }}</div>{% endif %}
    {% if book.author_note %}<div class="author-note">{{ book.author_note|raw }}</div>{% endif %}
</section>
</body>
</html>
